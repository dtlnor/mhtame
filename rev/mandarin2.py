p = int.from_bytes(bytes.fromhex("f33b6fb972a0b72515e45c391829e182ad8a9bdc0a64d3444d79c810ab863717"), byteorder='little')
q = int.from_bytes(bytes.fromhex("f99db75c39d0db920a72ae1c8c9470c156c54d6e05b269a2a63c648855c39b0b"), byteorder='little')
#C = int.from_bytes(bytes.fromhex("a1002346d9d854e5c18e4ce4eb641bed7d282226c7268648c1909d59abfa7215"), byteorder='little')
D = int.from_bytes(bytes.fromhex("e66f544afcce68c5ef07b9a07b277585344a1db61376e831f73b9fbd5f44f715000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"), byteorder='little')
K = int.from_bytes(bytes.fromhex("395097eefeffeffe000000000000000000000000000000000000000000000000"), byteorder='little')
E1 = 65537
E2 = 0x14
from sys import byteorder
from sympy import isprime, lcm
print(isprime(p))
print(isprime(q))
print(isprime(D))

n = p * q
#K = 76561198252339142
unk = K % q
print(hex(unk))
unk2 = pow(D, unk, n)
print(hex(unk2))
unk2 = pow(D, unk, q)
print(hex(unk2))

unk2 = pow(E1, -1, n)
print("idk: ", hex(unk2))

a = int.from_bytes(bytes.fromhex("d01b122349070f0de076ad6fb0833e4143829755c9b369c471da40c6ae702ab771d878c90c611500000000000000000000000000000000000000000000000000"), byteorder='little')
b = int.from_bytes(bytes.fromhex("bb39c81702d5495b671844d2f5ee2b77b811eb6e076b236e41ee7ce342f516120000000000000000000000000000000000000000000000000000000000000000"), byteorder='little')
print(hex(b))
print(hex(a))
unk = pow(b, K, p)
print(hex(unk))

"""
phi_n = int(lcm(p - 1, q - 1))
print(hex(n))
print(hex(phi_n))

d = pow(E1, -1, phi_n)
print(hex(d))
#d = pow(E2, -1, phi_n)
#print(hex(d))
d = pow(K, -1, phi_n)
print(hex(d))

# this is some hex number that gets initialized in the code
h = [0x31, 0x30, 0x32, 0x46, 0x37, 0x38, 0x31, 0x42, 0x41, 0x45, 0x31, 0x37, 0x46, 0x34, 0x39, 0x46, 0x39, 0x46, 0x37, 0x33, 0x31, 0x35, 0x36, 0x33, 0x31, 0x30, 0x30, 0x38, 0x37, 0x34, 0x45, 0x36, 0x41, 0x34, 0x45, 0x38, 0x34, 0x35, 0x42, 0x38, 0x41, 0x31, 0x38, 0x46, 0x44, 0x45, 0x41, 0x45, 0x33, 0x38, 0x30, 0x34, 0x32, 0x34, 0x31, 0x39, 0x32, 0x32, 0x39, 0x33, 0x32, 0x31, 0x31, 0x33, 0x30, 0x30, 0x36, 0x35, 0x37, 0x45, 0x35, 0x32, 0x43, 0x45, 0x31, 0x45, 0x35, 0x41, 0x39, 0x34, 0x30, 0x32, 0x44, 0x45, 0x34, 0x37, 0x37, 0x31, 0x42, 0x43, 0x42, 0x34, 0x38, 0x35, 0x30, 0x31, 0x42, 0x30, 0x35, 0x45, 0x44, 0x43, 0x33, 0x37, 0x31, 0x32, 0x36, 0x32, 0x37, 0x45, 0x34, 0x44, 0x35, 0x46, 0x43, 0x37, 0x39, 0x41, 0x35, 0x41, 0x44, 0x38, 0x42, 0x42, 0x35, 0x30, 0x46, 0x35, 0x33, 0x34, 0x44, 0x45, 0x37, 0x34, 0x30, 0x32, 0x34, 0x33, 0x32, 0x45, 0x42, 0x30, 0x34, 0x42, 0x41, 0x45, 0x32, 0x32, 0x45, 0x41, 0x44, 0x36, 0x45, 0x43, 0x42, 0x37, 0x45, 0x34, 0x33, 0x43, 0x44, 0x39, 0x44, 0x36, 0x43, 0x35, 0x38, 0x45, 0x41, 0x31, 0x34, 0x46, 0x34, 0x31, 0x35, 0x37, 0x39, 0x38, 0x32, 0x34, 0x38, 0x37, 0x45, 0x42, 0x36, 0x37, 0x42, 0x46, 0x32, 0x38, 0x46, 0x34, 0x43, 0x36, 0x39, 0x35, 0x35, 0x38, 0x37, 0x36, 0x45, 0x46, 0x46, 0x37, 0x38, 0x38, 0x45, 0x33, 0x43, 0x34, 0x31, 0x34, 0x44, 0x30, 0x41, 0x46, 0x32, 0x37, 0x42, 0x46, 0x35, 0x42, 0x42, 0x33, 0x43, 0x38, 0x37, 0x36, 0x42, 0x33, 0x34, 0x37, 0x38, 0x37, 0x45, 0x36, 0x34, 0x33, 0x35, 0x42, 0x46, 0x38, 0x39, 0x33, 0x41, 0x46, 0x35, 0x46, 0x36, 0x44, 0x32, 0x30, 0x42, 0x30, 0x37, 0x35, 0x78]
s = "0" + ''.join(chr(x) for x in reversed(h))
x = int.from_bytes(bytes.fromhex(s.strip("0x")), byteorder='little')
print(isprime(x))
print(hex(x))
"""
